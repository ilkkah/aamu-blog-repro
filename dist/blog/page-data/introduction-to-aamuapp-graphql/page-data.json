{"componentChunkName":"component---src-templates-blog-post-js","path":"/introduction-to-aamuapp-graphql/","result":{"data":{"site":{"siteMetadata":{"title":"Aamu.app blog"}},"aamu":{"BlogPost":{"title":"Introduction to Aamu.app GraphQL","publishDate":"2021-10-19T09:00:00.000Z","description":"How to use the database from a distance","heroImage":{"url":"https://pic.aamu.app/c78de4b4-c1ed-41e5-83af-a27352c12c31/652c5510-debe-4ffb-a5bc-89334b053c9f/1634671479716.jpg","image":{"id":"d762abb6-12ae-5fc8-b5a7-9903fcb295da","childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAFABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAduhaCf/xAAXEAEAAwAAAAAAAAAAAAAAAAABEBEi/9oACAEBAAEFAk1TH//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABYQAQEBAAAAAAAAAAAAAAAAADEAEP/aAAgBAQAGPwJnP//EABgQAAIDAAAAAAAAAAAAAAAAAAABEBFh/9oACAEBAAE/IWVGmP/aAAwDAQACAAMAAAAQi8//xAAWEQEBAQAAAAAAAAAAAAAAAAABECH/2gAIAQMBAT8QVyf/xAAVEQEBAAAAAAAAAAAAAAAAAAAQEf/aAAgBAgEBPxCn/8QAGxABAAICAwAAAAAAAAAAAAAAAQAhMfERcaH/2gAIAQEAAT8QQ4g4x1vyaAhi7n//2Q=="},"images":{"fallback":{"src":"/blog/static/e57f3bf370f9cc31f47d4ef275bacff1/b8172/1634671479716.jpg","srcSet":"/blog/static/e57f3bf370f9cc31f47d4ef275bacff1/f8c3f/1634671479716.jpg 750w,\n/blog/static/e57f3bf370f9cc31f47d4ef275bacff1/684ac/1634671479716.jpg 1080w,\n/blog/static/e57f3bf370f9cc31f47d4ef275bacff1/fc9bd/1634671479716.jpg 1366w,\n/blog/static/e57f3bf370f9cc31f47d4ef275bacff1/b8172/1634671479716.jpg 1920w","sizes":"100vw"},"sources":[{"srcSet":"/blog/static/e57f3bf370f9cc31f47d4ef275bacff1/a5556/1634671479716.webp 750w,\n/blog/static/e57f3bf370f9cc31f47d4ef275bacff1/003a3/1634671479716.webp 1080w,\n/blog/static/e57f3bf370f9cc31f47d4ef275bacff1/e5d5a/1634671479716.webp 1366w,\n/blog/static/e57f3bf370f9cc31f47d4ef275bacff1/dd931/1634671479716.webp 1920w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.2729166666666667}}}},"body":"<p>Aamu.app database supports two APIs: you can submit data into a database via just standard <em>html forms</em> – this works just one direction – to add data into the database. Also, you can get and put data into the database via <em>GraphQL</em>.</p>\n<p>As Wikipedia <a href=\"https://en.wikipedia.org/wiki/GraphQL\" target=\"_blank\">says it</a>, \"GraphQL is an open-source data query and manipulation language\". It's a query language, and it has a syntax for reading and writing the database. For testing it out, it is helpful to have a tool. I like <a href=\"https://altair-gql.sirmuel.design/\" target=\"_blank\">Altair</a>.</p>\n<p>To use Altair, or any similar tool, you first need to setup it with some information about your database; the database endpoint and the database API key. You can get the API key from the <em>database settings</em>. The database endpoint is this: <code>https://api.aamu.app/api/v1/graphql/</code>.</p>\n<p>After you have set those, there is the option to the get database schema. The schema will help you to query the database. In Altair the schema is called <em>Docs</em>. If you change the database structure, you can refresh the schema in the tool of your choice. In Altair, there is a refresh icon, which has a tooltip to <em>Reload Docs</em>.</p>\n<p><img src=\"https://pic.aamu.app/c78de4b4-c1ed-41e5-83af-a27352c12c31/652c5510-debe-4ffb-a5bc-89334b053c9f/1634699877668.jpg\" alt=\"\"></p>\n<p>You can browse around the schema. On the top, the schema has the following parts: <em>Query</em> and <em>Mutation</em>, which stand for reading and writing.</p>\n<p><img src=\"https://pic.aamu.app/c78de4b4-c1ed-41e5-83af-a27352c12c31/652c5510-debe-4ffb-a5bc-89334b053c9f/1634700200591.jpg\" alt=\"\"></p>\n<h2>Querying the database</h2>\n<p>Let's see, what we have in <em>Query</em>. We see that there are some fields, which correspond to our sheets (or tables) in our database. I am using the <em>aamu-blog</em> as an example, and in the aamu-blog there are two sheets: <em>Blog post</em> and <em>Person</em>.</p>\n<p>For each sheet there are two ways to query it: to get one specific row from it and to get multiple rows. Let's go through each case.</p>\n<p><img src=\"https://pic.aamu.app/c78de4b4-c1ed-41e5-83af-a27352c12c31/652c5510-debe-4ffb-a5bc-89334b053c9f/1634701341708.jpg\" alt=\"\"></p>\n<p>To get a single row, in this case a blog post, you would query it through one of its <em>unique fields</em>. You can set the field as unique by editing the <em>column properties</em> in the database sheet. There is a checkmark that makes the column <em>unique</em>. For blog posts, the slug is marked as unique. Slug stands for \"part of the url\":</p>\n<p><img src=\"https://pic.aamu.app/c78de4b4-c1ed-41e5-83af-a27352c12c31/652c5510-debe-4ffb-a5bc-89334b053c9f/1634700713455.jpg\" alt=\"\"></p>\n<p>So, you can get these blog posts by knowing its <em>slug</em> or by its <em>ID</em>. In practice, in this blog application, you would use the slug, as that is something that you know – the user will enter the url in the browser and that url will have the slug. So you use that slug the retrieve the correct blog post.</p>\n<p>Here is an example how you would query a single blog post (this particular one). In the parenthesis you would enter the unique field and in the braces you would enter the fields that the query should return for this particular item.</p>\n<div class=\"remark-highlight\"><pre class=\"language-graphql\"><code class=\"language-graphql\"><span class=\"token keyword\">query</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property-query\">BlogPost</span> <span class=\"token punctuation\">(</span><span class=\"token attr-name\">slug</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"introduction-to-aamuapp-graphql\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">id</span>\n    <span class=\"token property\">created</span>\n    <span class=\"token property\">updated</span>\n    <span class=\"token property\">title</span>\n    <span class=\"token property\">slug</span>\n    <span class=\"token property\">description</span>\n    <span class=\"token property\">body</span>\n    <span class=\"token property\">publishDate</span>\n    <span class=\"token property\">status</span>\n  <span class=\"token punctuation\">}</span> \n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>You can also get items by querying the field <em>BlogPostCollection</em>. This gives you from zero to multiple rows. You can also do filtering, sorting and pagination. In practice you probably will want to do at least filtering.</p>\n<p><img src=\"https://pic.aamu.app/c78de4b4-c1ed-41e5-83af-a27352c12c31/652c5510-debe-4ffb-a5bc-89334b053c9f/1634701474749.jpg\" alt=\"\"></p>\n<p>Let's see how the filtering goes. By clicking <em>filter</em>, you will get a list of fields by which you can filter. In practice you can filter by any field in the sheet.</p>\n<p>Let's see how <em>aamu-blog</em> gets the blog posts for its main page. It will filter by <code>status</code> and sort by <code>publishDate</code>. Here is the query:</p>\n<div class=\"remark-highlight\"><pre class=\"language-graphql\"><code class=\"language-graphql\"><span class=\"token keyword\">query</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property-query\">BlogPostCollection</span> <span class=\"token punctuation\">(</span><span class=\"token attr-name\">filter</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token attr-name\">status</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token attr-name\">EQ</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"published\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token attr-name\">sort</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token attr-name\">publishDate</span><span class=\"token punctuation\">:</span> <span class=\"token constant\">DESC</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">title</span>\n        <span class=\"token property\">slug</span>\n        <span class=\"token property\">publishDate</span>\n        <span class=\"token property\">description</span>\n      <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>You will notice that we have used <code>EQ</code> to filter for <code>status</code>. For retrieving single items through unique fields this isn't needed, as the item is always retrieving by the exact same value, but for retrieving multiple items there are more possibilities. In Altair, you can get help by pressing <em>Ctrl + space</em>. Altair will give you a list of options how you can filter, like this:</p>\n<p><img src=\"https://pic.aamu.app/c78de4b4-c1ed-41e5-83af-a27352c12c31/652c5510-debe-4ffb-a5bc-89334b053c9f/1634703813603.jpg\" alt=\"\"></p>\n<p><code>EQ</code> stands for \"equals\", <code>GT</code> stands for \"greater than\", <code>LT</code> stands for \"less than\", etc.</p>\n<p>For sorting, you can get similar help. There are two ways to sort, ascending and descending:</p>\n<p><img src=\"https://pic.aamu.app/c78de4b4-c1ed-41e5-83af-a27352c12c31/652c5510-debe-4ffb-a5bc-89334b053c9f/1634704152244.jpg\" alt=\"\"></p>\n<p>Pagination is pretty straight forward. You would use it like this:</p>\n<div class=\"remark-highlight\"><pre class=\"language-graphql\"><code class=\"language-graphql\"><span class=\"token keyword\">query</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property-query\">BlogPostCollection</span> <span class=\"token punctuation\">(</span> <span class=\"token attr-name\">filter</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token attr-name\">status</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token attr-name\">EQ</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"published\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token attr-name\">sort</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token attr-name\">publishDate</span><span class=\"token punctuation\">:</span>  <span class=\"token constant\">DESC</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token attr-name\">pagination</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token attr-name\">limit</span><span class=\"token punctuation\">:</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token attr-name\">skip</span><span class=\"token punctuation\">:</span> <span class=\"token number\">20</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">title</span>\n        <span class=\"token property\">slug</span>\n        <span class=\"token property\">publishDate</span>\n        <span class=\"token property\">description</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<p>That covers querying the database.</p>\n","slug":"introduction-to-aamuapp-graphql","author":{"id":"29940627-51e8-4fd0-82ab-d718ddfe802f","created":"2021-09-25T23:02:23.482Z","updated":"2022-07-15T02:45:21.305Z","name":"Ilkka Huotari","bio":"","title":"","image":{"url":"https://pic.aamu.app/c78de4b4-c1ed-41e5-83af-a27352c12c31/652c5510-debe-4ffb-a5bc-89334b053c9f/1657853120956.jpg","image":{"id":"3692d700-7283-5bac-8335-8b4fd1f49c1a","childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAMCBAX/xAAXAQADAQAAAAAAAAAAAAAAAAAAAQMC/9oADAMBAAIQAxAAAAGU9ym9KsqXIUfqAP/EABoQAAIDAQEAAAAAAAAAAAAAAAECAAMRBBL/2gAIAQEAAQUCYTGmGW6gPToU+g51KFFlyqEn/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAGBEAAgMAAAAAAAAAAAAAAAAAAAEQERL/2gAIAQIBAT8BVmhR/8QAGxAAAgIDAQAAAAAAAAAAAAAAAAECESExQRD/2gAIAQEABj8CeLNeXdmslkr4iMXpjiuM/8QAGxABAAMBAQEBAAAAAAAAAAAAAQARITFhUXH/2gAIAQEAAT8hBFp49gTpM6TzWL6xmVKkt+o1aIRXwlp9m1NWUvZ//9oADAMBAAIAAwAAABCnBwH/xAAXEQEBAQEAAAAAAAAAAAAAAAABABEx/9oACAEDAQE/EAMd7bMN/8QAFxEBAQEBAAAAAAAAAAAAAAAAAQARMf/aAAgBAgEBPxAZlDlwyX//xAAcEAEBAAMBAAMAAAAAAAAAAAABEQAhMUFRkbH/2gAIAQEAAT8QQk/CDpz7w4AtDKbON93kwCQ6Fw46QXTeIeoar0fMnbgG4P7ktWteNM31oUjxcYaiRW+5/9k="},"images":{"fallback":{"src":"/blog/static/57ad26e5f38695d0257cc252a59229e2/e07e1/1657853120956.jpg","srcSet":"/blog/static/57ad26e5f38695d0257cc252a59229e2/74ef0/1657853120956.jpg 25w,\n/blog/static/57ad26e5f38695d0257cc252a59229e2/6ac16/1657853120956.jpg 50w,\n/blog/static/57ad26e5f38695d0257cc252a59229e2/e07e1/1657853120956.jpg 100w,\n/blog/static/57ad26e5f38695d0257cc252a59229e2/dd515/1657853120956.jpg 200w","sizes":"(min-width: 100px) 100px, 100vw"},"sources":[{"srcSet":"/blog/static/57ad26e5f38695d0257cc252a59229e2/2fa99/1657853120956.webp 25w,\n/blog/static/57ad26e5f38695d0257cc252a59229e2/dbc4a/1657853120956.webp 50w,\n/blog/static/57ad26e5f38695d0257cc252a59229e2/d8057/1657853120956.webp 100w,\n/blog/static/57ad26e5f38695d0257cc252a59229e2/2e34e/1657853120956.webp 200w","type":"image/webp","sizes":"(min-width: 100px) 100px, 100vw"}]},"width":100,"height":100}}}}}}}},"pageContext":{"slug":"introduction-to-aamuapp-graphql"}},"staticQueryHashes":[]}